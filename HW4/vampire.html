<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

  <title>Is My Classmate a Vampire?</title>
  <style>
    body {
      background-color: black;
      color:  white;
    }

    #chart_div {
      background-color: black;
      position:  absolute;
      right: 50px;
    }

    #chart_div text {
      fill: white !important;
    }
  </style>
</head>
<body>
  <h1 align="center">Is My Classmate a Vampire?</h1>
  <h3 align="center">Created by Malcolm Flaherty</h3>
  <div class="container">
    <p align="center">As the years go by, students everywhere are growing more concerned that their classmates might be vampires in disguise. How is anyone supposed to know who to trust? Well worry not, with this tool you can easily discover any hidden vampires! Simply enter the name of a student and give us some information about them, and our vampire testing application will tell you if you've got a vampire for a friend!</p>
  </div>

  <div>
    <!--Div that will hold the pie chart-->
    <div id="chart_div"></div>
  </div>

  <!--Input Fields-->
  <div class="container">
      <div class="row">
        <div class="col-md-6">
          <label for="logicSelect">Select Model Logic:</label>
          <select class="form-control" id="logic_select">
            <option value='1'>Random Guess</option>
            <option value='2'>Threshold Based </option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6">
          <label for="name_box">Name (First and Last):</label>
          <input type="text" class="form-control" id="name_box" placeholder="Name">
        </div>
      </div>

      <div class="row">
        <div class="col-md-6" align="center">
          <h4>Check all that apply to this student:</h4>
          <label><input type="checkbox" id="shadow_checkbox">Has a Shadow</label>
          <label><input type="checkbox" id="garlic_checkbox">Eats Garlic</label>
          <label><input type="checkbox" id="complextion_checkbox">Has a Pale Complexion</label>
        </div>
      </div>

      <button class="btn btn-primary" onclick="addStudent()">Submit</button>
  </div>

  <!--Sample Data Table-->
  <div class="container">
    <table class="table table_bordered" id="student_table">
      <h1>Student Database</h1>
      <thead>
        <tr>
          <th>Name</th>
          <th>Vampire?</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>John Doe</td>
          <td>Yes</td>
        </tr>
        <tr>
          <td>Lee Smith</td>
          <td>Yes</td>
        </tr>
        <tr>
          <td>Emma Brown</td>
          <td>No</td>
        </tr>
        <tr>
          <td>Ava Jones</td>
          <td>No</td>
        </tr>
        <tr>
          <td>Alex Griffey</td>
          <td>Yes</td>
        </tr>
      </tbody>
    </table>
  </div>

<script type="text/javascript">
      // Load the Visualization API and the corechart package.
      // current means latest official release of Google Charts to be loaded
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);

      var chart;
      var data;
      var options;
      var num_human = 0;
      var num_vampire = 0;

      var table = document.getElementById("student_table");

      // Update human and vampire counts based on table data
      function updateCounts() {
        var count = 0;
        for (var i = 1; i < table.rows.length; i++) {
          if (table.rows[i].cells[1].innerHTML === 'Yes') {
            count++;
          }
        }
        num_vampire = count;
        num_human = table.rows.length - 1 - count;
      }

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {
        // Update human and vampire counts
        updateCounts();
        // Create the data table.
        data = new google.visualization.DataTable();
        data.addColumn('string', 'Element');
        data.addColumn('number', 'Number');
        data.addRows([
          ['Human', num_human],
          ['Vampire', num_vampire]
        ]);

        // Set chart options
        options = {'title':'How many vampires in the class?',
                       'width':500,
                       'height':300,
                      'backgroundColor':'black',
                    };

        // Instantiate and draw our chart, passing in some options.
        chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }

      // Add a new student to the database table, and determine if they are a vampire based on the selected model logic
      function addStudent() {
        var table = document.getElementById("student_table");

        // Initialize data values based on user inputs
        var name = document.getElementById("name_box").value;
        var garlic = document.getElementById("garlic_checkbox").checked;
        var shadow = document.getElementById("shadow_checkbox").checked;
        var pale = document.getElementById("complextion_checkbox").checked;

        // If no name has been entered, do not update the table
        if(name != '') {
          // Add a row to the student table and set the first column value to the new students name
          var row = table.insertRow(1);
          var cell1 = row.insertCell(0);
          cell1.innerHTML = name;

          // Determine if new student is a vampire
          var cell2 = row.insertCell(1);

          // Random Guess
          if (document.getElementById("logic_select").value == 1) {
            var rand = Math.random();
            if (rand > 0.50) {
              cell2.innerHTML = "Yes";
            }
            else { 
              cell2.innerHTML = "No"; 
            }
          }

          // Threshhold Based
          else if (document.getElementById("logic_select").value == 2) {
            var v = 0;
            if (!shadow) { v += 4; }
            if (!garlic) { v += 3; }
            if (pale) { v += 3; }

            if (v > 6) {
              cell2.innerHTML = "Yes";
            }
            else {
              cell2.innerHTML = "No";
            }
          }

          // Update the pie chart to reflec new addition
          drawChart();
        }

        else {
          window.alert("Please enter a students name.")
        }
      }
</script>

</body>
</html>